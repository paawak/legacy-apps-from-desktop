/*
 * CustomerGroupMaster301.java
 *
 * Created on November 16, 2002, 2:26 PM
 */

/**
 *
 * @author  Palash
 */

package view.master;

import java.sql.*;
import java.util.*;
import javax.swing.JOptionPane;
import java.awt.Rectangle;

public class CustomerGroupMasterPanel extends javax.swing.JPanel {

    /** Creates new form CustomerGroupMaster201 */
    public CustomerGroupMasterPanel() {
        initComponents();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        btngrpViewOptions = new javax.swing.ButtonGroup();
        btngrpViewOptions.add(rdbtAllData);
        btngrpViewOptions.add(rdbtYData);
        btngrpViewOptions.add(rdbtNData);
        pnlHome = new javax.swing.JPanel();
        lblFormHeadingH = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        rdbtAllData = new javax.swing.JRadioButton();
        rdbtNData = new javax.swing.JRadioButton();
        rdbtYData = new javax.swing.JRadioButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblDB = new javax.swing.JTable();
        btAdd = new javax.swing.JButton();
        btModify = new javax.swing.JButton();
        btSearch = new javax.swing.JButton();
        btActivate = new javax.swing.JButton();
        btInactivate = new javax.swing.JButton();
        btExit = new javax.swing.JButton();
        pnlSearch = new javax.swing.JPanel();
        cbSearch = new javax.swing.JComboBox();
        cbSearch.addItem("CODE");
        cbSearch.addItem("NAME");
        txtSearch = new javax.swing.JTextField();
        jScrollPane2 = new javax.swing.JScrollPane();
        listSearch = new javax.swing.JList();
        btSearchCancel = new javax.swing.JButton();
        pnlAddMod = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        txtCode = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        txtName = new javax.swing.JTextField();
        btAddSave = new javax.swing.JButton();
        btAddCancel = new javax.swing.JButton();
        btAddSearch = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        txtRemarks = new javax.swing.JTextField();
        lblFormHeadingH1 = new javax.swing.JLabel();

        setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                formComponentShown(evt);
            }
        });

        addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                formKeyPressed(evt);
            }
        });

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        pnlHome.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        pnlHome.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                pnlHomeComponentShown(evt);
            }
            public void componentHidden(java.awt.event.ComponentEvent evt) {
                pnlHomeComponentHidden(evt);
            }
        });

        pnlHome.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                pnlHomeKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                pnlHomeKeyReleased(evt);
            }
        });

        lblFormHeadingH.setText("Customer Group Master");
        lblFormHeadingH.setForeground(new java.awt.Color(0, 51, 204));
        lblFormHeadingH.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblFormHeadingH.setFont(new java.awt.Font("Lucida Sans Unicode", 1, 24));
        pnlHome.add(lblFormHeadingH, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 20, 310, -1));

        jPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel1.setBorder(new javax.swing.border.TitledBorder(null, "View Options", javax.swing.border.TitledBorder.LEFT, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 14)));
        rdbtAllData.setToolTipText(" ");
        rdbtAllData.setMnemonic('l');
        rdbtAllData.setSelected(true);
        rdbtAllData.setText("All Data");
        btngrpViewOptions.add(rdbtAllData);
        rdbtAllData.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdbtAllDataActionPerformed(evt);
            }
        });

        jPanel1.add(rdbtAllData, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 20, 80, -1));

        rdbtNData.setToolTipText(" ");
        rdbtNData.setMnemonic('I');
        rdbtNData.setText("Inactive Data");
        btngrpViewOptions.add(rdbtNData);
        rdbtNData.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdbtNDataActionPerformed(evt);
            }
        });

        jPanel1.add(rdbtNData, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 20, -1, -1));

        rdbtYData.setToolTipText(" ");
        rdbtYData.setMnemonic('t');
        rdbtYData.setText("Active Data");
        btngrpViewOptions.add(rdbtYData);
        rdbtYData.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdbtYDataActionPerformed(evt);
            }
        });

        jPanel1.add(rdbtYData, new org.netbeans.lib.awtextra.AbsoluteConstraints(180, 20, -1, -1));

        pnlHome.add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 70, 500, 60));

        jScrollPane1.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentResized(java.awt.event.ComponentEvent evt) {
                jScrollPane1ComponentResized(evt);
            }
        });

        tblDB.setDebugGraphicsOptions(javax.swing.DebugGraphics.BUFFERED_OPTION);
        displayData();
        tblDB.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                tblDBKeyReleased(evt);
            }
        });

        tblDB.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblDBMouseClicked(evt);
            }
        });

        jScrollPane1.setViewportView(tblDB);

        pnlHome.add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 130, 500, 240));

        btAdd.setToolTipText(" ");
        btAdd.setMnemonic('A');
        btAdd.setText("ADD");
        btAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAddActionPerformed(evt);
            }
        });

        pnlHome.add(btAdd, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 420, 110, -1));

        btModify.setToolTipText(" ");
        btModify.setMnemonic('M');
        btModify.setText("MODIFY");
        btModify.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btModifyActionPerformed(evt);
            }
        });

        pnlHome.add(btModify, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 420, 110, -1));

        btSearch.setToolTipText(" ");
        btSearch.setMnemonic('S');
        btSearch.setText("SEARCH");
        btSearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btSearchActionPerformed(evt);
            }
        });

        pnlHome.add(btSearch, new org.netbeans.lib.awtextra.AbsoluteConstraints(260, 420, 110, -1));

        btActivate.setToolTipText(" ");
        btActivate.setMnemonic('C');
        btActivate.setText("ACTIVATE");
        btActivate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btActivateActionPerformed(evt);
            }
        });

        pnlHome.add(btActivate, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 420, 110, -1));

        btInactivate.setToolTipText(" ");
        btInactivate.setMnemonic('N');
        btInactivate.setText("INACTIVATE");
        btInactivate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btInactivateActionPerformed(evt);
            }
        });

        pnlHome.add(btInactivate, new org.netbeans.lib.awtextra.AbsoluteConstraints(480, 420, 110, -1));

        btExit.setToolTipText(" ");
        btExit.setMnemonic('X');
        btExit.setText("EXIT");
        btExit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btExitActionPerformed(evt);
            }
        });

        pnlHome.add(btExit, new org.netbeans.lib.awtextra.AbsoluteConstraints(590, 420, 110, -1));

        pnlSearch.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        pnlSearch.setBorder(new javax.swing.border.TitledBorder(null, "Search", javax.swing.border.TitledBorder.LEFT, javax.swing.border.TitledBorder.TOP, new java.awt.Font("Dialog", 0, 14)));
        pnlSearch.setVisible(false);
        pnlSearch.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                pnlSearchComponentShown(evt);
            }
            public void componentHidden(java.awt.event.ComponentEvent evt) {
                pnlSearchComponentHidden(evt);
            }
        });

        cbSearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbSearchActionPerformed(evt);
            }
        });

        pnlSearch.add(cbSearch, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 30, 170, 20));

        txtSearch.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtSearchKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtSearchKeyReleased(evt);
            }
        });

        pnlSearch.add(txtSearch, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 65, 170, 20));

        listSearch.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                listSearchKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                listSearchKeyReleased(evt);
            }
        });

        listSearch.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
            public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
                listSearchValueChanged(evt);
            }
        });

        listSearch.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                listSearchMouseClicked(evt);
            }
        });

        jScrollPane2.setViewportView(listSearch);

        pnlSearch.add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 100, 170, 160));

        btSearchCancel.setToolTipText(" ");
        btSearchCancel.setMnemonic('E');
        btSearchCancel.setText("SEARCH  CANCEL");
        btSearchCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btSearchCancelActionPerformed(evt);
            }
        });

        pnlSearch.add(btSearchCancel, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 270, 170, -1));

        pnlHome.add(pnlSearch, new org.netbeans.lib.awtextra.AbsoluteConstraints(530, 70, 180, 300));

        add(pnlHome, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 750, 750));

        pnlAddMod.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        pnlAddMod.setVisible(false);
        pnlAddMod.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                pnlAddModComponentShown(evt);
            }
            public void componentHidden(java.awt.event.ComponentEvent evt) {
                pnlAddModComponentHidden(evt);
            }
        });

        jLabel2.setText("CODE");
        pnlAddMod.add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 100, -1, 20));

        txtCode.setEditable(false);
        txtCode.setBackground(new java.awt.Color(204, 255, 255));
        txtCode.setDisabledTextColor(new java.awt.Color(204, 204, 255));
        pnlAddMod.add(txtCode, new org.netbeans.lib.awtextra.AbsoluteConstraints(280, 100, 230, -1));

        jLabel3.setText("NAME");
        pnlAddMod.add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 140, -1, 20));

        txtName.setBackground(new java.awt.Color(204, 255, 255));
        txtName.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtNameKeyTyped(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtNameKeyReleased(evt);
            }
        });

        pnlAddMod.add(txtName, new org.netbeans.lib.awtextra.AbsoluteConstraints(280, 140, 230, -1));

        btAddSave.setToolTipText(" ");
        btAddSave.setMnemonic('S');
        btAddSave.setText("SAVE");
        btAddSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAddSaveActionPerformed(evt);
            }
        });

        pnlAddMod.add(btAddSave, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 230, 90, -1));

        btAddCancel.setToolTipText(" ");
        btAddCancel.setMnemonic('C');
        btAddCancel.setText("CANCEL");
        btAddCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAddCancelActionPerformed(evt);
            }
        });

        pnlAddMod.add(btAddCancel, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 230, 90, -1));

        btAddSearch.setToolTipText(" ");
        btAddSearch.setMnemonic('R');
        btAddSearch.setText("SEARCH");
        btAddSearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAddSearchActionPerformed(evt);
            }
        });

        pnlAddMod.add(btAddSearch, new org.netbeans.lib.awtextra.AbsoluteConstraints(320, 230, 90, -1));

        jLabel4.setText("REMARKS");
        pnlAddMod.add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 180, 60, 20));

        txtRemarks.setBackground(new java.awt.Color(204, 255, 255));
        txtRemarks.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtRemarksFocusGained(evt);
            }
        });

        txtRemarks.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtRemarksKeyReleased(evt);
            }
        });

        pnlAddMod.add(txtRemarks, new org.netbeans.lib.awtextra.AbsoluteConstraints(280, 180, 230, -1));

        lblFormHeadingH1.setText("Customer Group Master");
        lblFormHeadingH1.setForeground(new java.awt.Color(0, 51, 204));
        lblFormHeadingH1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblFormHeadingH1.setFont(new java.awt.Font("Lucida Sans Unicode", 1, 24));
        pnlAddMod.add(lblFormHeadingH1, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 20, 310, -1));

        add(pnlAddMod, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 750, 750));

    }//GEN-END:initComponents

    private void txtRemarksFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtRemarksFocusGained
        txtRemarks.selectAll();
    }//GEN-LAST:event_txtRemarksFocusGained

    private void txtRemarksKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtRemarksKeyReleased
StringBuffer sb = new StringBuffer(35);
sb.append(txtRemarks.getText());
if(sb.length()>30){
    sb.setLength(30);
    txtRemarks.setText(""+sb);
}
    }//GEN-LAST:event_txtRemarksKeyReleased

    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
     try{
            accessDB();
            String ss = "SELECT * FROM SemaPhores WHERE TableName = 'CO_Grp'";
            
            ResultSet res = stat.executeQuery(ss);
            
            if(!res.next()){
                String ss1="Insert into SemaPhores (TableName,CtrName,MaxCtr) values('"+tableName+"','CO_Grp_',1)";
               stat.executeUpdate(ss1);               
            }//end if
            con.close();
        }//end try
        catch(Exception e){
        }//end catch*/
        
    }//GEN-LAST:event_formWindowOpened

    private void btAddSearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAddSearchActionPerformed
addCancelPressed();               
        searchPressed();
    }//GEN-LAST:event_btAddSearchActionPerformed

    private void listSearchMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_listSearchMouseClicked
 if(!listSelectionChanged){
        listClicked2+=evt.getClickCount();     
 }//end if
 else if(listSelectionChanged){
    listClicked2=0;
    listSelectionChanged=false;
 }//end else  
        if( listClicked2==2){
    selrow=tblDB.getSelectedRow();
   click=true;
   searchCancelPressed();
         modifyPressed();
              listClicked2=0;
             tblDB.clearSelection();    
                   }//*/
        else{
   tblDB.clearSelection();    
int index=searchElement(  (String)( listSearch.getSelectedValue() )  ,unsorted   );
      tblDB.changeSelection( index ,0,true,false);
        }

    }//GEN-LAST:event_listSearchMouseClicked

    private void listSearchValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_listSearchValueChanged
                txtSearch.setText(""+listSearch.getSelectedValue());
                txtSearch.selectAll();
                listSelectionChanged=true;

    }//GEN-LAST:event_listSearchValueChanged

    private void txtNameKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNameKeyReleased
StringBuffer sb = new StringBuffer(35);
sb.append(txtName.getText());
if(sb.length()>30){
    sb.setLength(30);
    txtName.setText(""+sb);
}
    }//GEN-LAST:event_txtNameKeyReleased

    private void txtNameKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNameKeyTyped
    }//GEN-LAST:event_txtNameKeyTyped

    private void tblDBKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tblDBKeyReleased
        if( evt.getKeyCode() == evt.VK_UP || evt.getKeyCode() == evt.VK_DOWN || evt.getKeyCode() == evt.VK_TAB){
              selrow = tblDB.getSelectedRow() ;
              
            if(selrow>=0)
                click = true;
            else
                click = false;

        }

    }//GEN-LAST:event_tblDBKeyReleased

    private void pnlSearchComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_pnlSearchComponentShown

jScrollPane1.setLocation(30,130);
jPanel1.setLocation(30,70);
     tblDB.clearSelection();
int index=searchElement(  (String)( listSearch.getSelectedValue() )  ,unsorted   );
      tblDB.changeSelection( index ,0,true,false);

    }//GEN-LAST:event_pnlSearchComponentShown

    private void jScrollPane1ComponentResized(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_jScrollPane1ComponentResized
 h=tblDB.getRowHeight()*(rowShown+1); 
 if(h<240)
jScrollPane1.setSize(500,h+5);  
 else
     jScrollPane1.setSize(500,240);  
 // Add your handling code here:
    }//GEN-LAST:event_jScrollPane1ComponentResized

    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked

    }//GEN-LAST:event_formMouseClicked

    private void formComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_formComponentShown
        displayData();
    }//GEN-LAST:event_formComponentShown

    private void pnlAddModComponentHidden(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_pnlAddModComponentHidden
home=true;
    }//GEN-LAST:event_pnlAddModComponentHidden

    private void pnlHomeComponentHidden(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_pnlHomeComponentHidden
home=false;
    }//GEN-LAST:event_pnlHomeComponentHidden

    private void pnlHomeComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_pnlHomeComponentShown
displayData();
    }//GEN-LAST:event_pnlHomeComponentShown

    private void formKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_formKeyPressed
if(evt.getKeyCode()==evt.VK_ALT)
    btSearchCancel.requestFocus();
    }//GEN-LAST:event_formKeyPressed

    private void pnlHomeKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_pnlHomeKeyReleased

    }//GEN-LAST:event_pnlHomeKeyReleased

    private void pnlHomeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_pnlHomeKeyPressed

    }//GEN-LAST:event_pnlHomeKeyPressed

    private void btInactivateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btInactivateActionPerformed
 activatePressed();
 tblDB.clearSelection();    
    }//GEN-LAST:event_btInactivateActionPerformed

    private void btActivateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btActivateActionPerformed
activate=true;
        activatePressed();
activate=false;
tblDB.clearSelection();    
    }//GEN-LAST:event_btActivateActionPerformed

    private void pnlAddModComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_pnlAddModComponentShown
if(add){
    btAddSearch.setEnabled(false);
    btAddSearch.setVisible(false);
    generateCode();

    txtName.requestFocus();
}//end if
else{
    btAddSearch.setEnabled(true);
    btAddSearch.setVisible(true);
    txtName.requestFocus();
    txtName.selectAll();
}//end else
    }//GEN-LAST:event_pnlAddModComponentShown

    private void btExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btExitActionPerformed
 this.setVisible(false);
    }//GEN-LAST:event_btExitActionPerformed

    private void pnlSearchComponentHidden(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_pnlSearchComponentHidden
btAdd.setEnabled(true);
btModify.setEnabled(true);
btSearch.setEnabled(true);
btActivate.setEnabled(true);
btInactivate.setEnabled(true);
btExit.setEnabled(true);
    rdbtAllData.setEnabled(true);
    rdbtYData.setEnabled(true);
   rdbtNData.setEnabled(true);
    rdbtAllData.setSelected(true);
    displayData();
   rdbtAllData.requestFocus();
    }//GEN-LAST:event_pnlSearchComponentHidden

    private void btSearchCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btSearchCancelActionPerformed
searchCancelPressed();
    }//GEN-LAST:event_btSearchCancelActionPerformed

    private void listSearchKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_listSearchKeyReleased
int keyCode=evt.getKeyCode();

if(keyCode==evt.VK_ENTER){
    
}//end if

 if(keyCode==evt.VK_DOWN||keyCode==evt.VK_UP){
     tblDB.clearSelection();
int index=searchElement(  (String)( listSearch.getSelectedValue() )  ,unsorted   );
      tblDB.changeSelection( index ,0,true,false);
}//end  if
    }//GEN-LAST:event_listSearchKeyReleased

    private void listSearchKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_listSearchKeyPressed

int keyCode=evt.getKeyCode();

if(keyCode==evt.VK_ENTER){
    selrow=tblDB.getSelectedRow();
   click=true;
   searchCancelPressed();
         modifyPressed();
    }//end if        
    }//GEN-LAST:event_listSearchKeyPressed

    private void txtSearchKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSearchKeyReleased
  
        
        int keyCode=evt.getKeyCode();
        
        if(keyCode==evt.VK_DOWN||keyCode==evt.VK_UP){
     tblDB.clearSelection();
int index=searchElement(  (String)( listSearch.getSelectedValue() )  ,unsorted   );
      tblDB.changeSelection( index ,0,true,false);

       listSearch.requestFocus();
}//end if
if(keyCode==evt.VK_RIGHT||keyCode==evt.VK_HOME||keyCode==evt.VK_END||keyCode==evt.VK_LEFT )
    ;//blank stat
else
      if(key.length()>0){
                txtSearch.setText(""+listSearch.getSelectedValue());
              System.out.println("key = \t"+key);
      txtSearch.setSelectionStart( key.length() );
      }//end if
        
    }//GEN-LAST:event_txtSearchKeyReleased

    private void txtSearchKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSearchKeyPressed
        char keyChar=evt.getKeyChar();
        int keyCode=evt.getKeyCode();
if(key.equals("")&&keyCode==evt.VK_BACK_SPACE)
    ;//blank statement
        else if(keyCode==evt.VK_BACK_SPACE){
sb= new StringBuffer(key);
sb.setLength(sb.length()-1);
key=sb.toString();
}//end if 
else if(keyCode==evt.VK_ENTER){
    selrow=tblDB.getSelectedRow();
   click=true;
   searchCancelPressed();
         modifyPressed();


}//end else if 1
        else if(keyCode==evt.VK_DOWN||keyCode==evt.VK_UP||keyCode==evt.VK_BACK_SPACE ||keyCode==evt.VK_DELETE   ||keyCode==evt.VK_SPACE ||keyCode==evt.VK_CAPS_LOCK ||keyCode==evt.VK_SHIFT||keyCode==evt.VK_TAB || keyCode==evt.VK_PAGE_DOWN || keyCode==evt.VK_PAGE_UP){ 
    ;
}//end else if 3
        else if(keyCode==evt.VK_ALT || keyCode==evt.VK_CONTROL){ 
     tblDB.clearSelection();
int index=searchElement(  (String)( listSearch.getSelectedValue() )  ,unsorted   );
      tblDB.changeSelection( index ,0,true,false);

}//end else if 3        
        else if(keyCode==evt.VK_RIGHT||keyCode==evt.VK_HOME||keyCode==evt.VK_END||keyCode==evt.VK_LEFT ){ 
    //txtSearch.setSelectionStart(txtSearch.getText().length());
            ;
}//end else if 3        
else if(keyCode>=32&&keyCode<=93||keyCode>=95&&keyCode<=126){
 tblDB.clearSelection();    
key+=String.valueOf(keyChar); 
key=key.trim();
search();
}//end else if 2
else
  JOptionPane.showMessageDialog(this," Enter valid chararters ","ERROR!",JOptionPane.ERROR_MESSAGE);    

    }//GEN-LAST:event_txtSearchKeyPressed

    private void cbSearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbSearchActionPerformed
        key=""; 
            txtSearch.setText("");

        search();       
    }//GEN-LAST:event_cbSearchActionPerformed

    private void btSearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btSearchActionPerformed
        searchPressed();
    }//GEN-LAST:event_btSearchActionPerformed

    private void btModifyActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btModifyActionPerformed
        modifyPressed();
 
    }//GEN-LAST:event_btModifyActionPerformed

    private void btAddCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAddCancelActionPerformed
addCancelPressed();        
    }//GEN-LAST:event_btAddCancelActionPerformed

    private void btAddSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAddSaveActionPerformed
     addSavePressed();

    }//GEN-LAST:event_btAddSaveActionPerformed

    private void btAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAddActionPerformed
addPressed();
    }//GEN-LAST:event_btAddActionPerformed

    private void tblDBMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblDBMouseClicked
click=true;
selrow=tblDB.getSelectedRow();                
    }//GEN-LAST:event_tblDBMouseClicked

    private void rdbtNDataActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdbtNDataActionPerformed

btInactivate.setEnabled(false);
btAdd.setEnabled(false);
btModify.setEnabled(false);
btActivate.setEnabled(true);

        displayData();       
    }//GEN-LAST:event_rdbtNDataActionPerformed

    private void rdbtYDataActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdbtYDataActionPerformed
        btActivate.setEnabled(false);
        btInactivate.setEnabled(true);
        btModify.setEnabled(true);
        btAdd.setEnabled(true);
        displayData();
    }//GEN-LAST:event_rdbtYDataActionPerformed

    private void rdbtAllDataActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdbtAllDataActionPerformed
         btInactivate.setEnabled(true);
        btActivate.setEnabled(true);
        btAdd.setEnabled(true);
         btModify.setEnabled(true);
         displayData();
    }//GEN-LAST:event_rdbtAllDataActionPerformed

    /** Exit the Application */
    private void exitForm(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_exitForm
    }//GEN-LAST:event_exitForm

    /**
    * @param args the command line arguments
    */
    /*public static void main(String args[]) {
                       new CustomerGroupMaster301().show(); 
    }//*/


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField txtRemarks;
    private javax.swing.JPanel pnlHome;
    private javax.swing.JTextField txtName;
    private javax.swing.JButton btActivate;
    private javax.swing.JLabel lblFormHeadingH1;
    private javax.swing.JRadioButton rdbtYData;
    private javax.swing.JTextField txtSearch;
    private javax.swing.JButton btSearch;
    private javax.swing.JButton btAddCancel;
    private javax.swing.JLabel lblFormHeadingH;
    private javax.swing.JPanel pnlSearch;
    private javax.swing.JButton btAdd;
    private javax.swing.JButton btModify;
    private javax.swing.JPanel pnlAddMod;
    private javax.swing.JButton btSearchCancel;
    private javax.swing.JButton btInactivate;
    private javax.swing.JTextField txtCode;
    private javax.swing.JRadioButton rdbtAllData;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JTable tblDB;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JList listSearch;
    private javax.swing.JRadioButton rdbtNData;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JButton btAddSave;
    private javax.swing.JButton btExit;
    private javax.swing.ButtonGroup btngrpViewOptions;
    private javax.swing.JButton btAddSearch;
    private javax.swing.JComboBox cbSearch;
    // End of variables declaration//GEN-END:variables

    private void count(){
        try{
            rowTotal=0;cols=0;i=0;j=0;rowY=0;

accessDB();
String ss,ss1;
   ss="SELECT * FROM "+tableName;
   ResultSet res = stat.executeQuery(ss); 
      ResultSetMetaData md = res.getMetaData();
     /**   in the database , we have the counter field which is autonumber.
 *      we dont want to display it in the front end.
 */   

   cols = md.getColumnCount()-1;
   tableColHeads=new String[cols];
   for(i=1;i<=cols;i++)
       tableColHeads[i-1]=md.getColumnName(i+1);


   ss1=" SELECT COUNT(*) FROM "+tableName;
  ResultSet res1 =   stat.executeQuery(ss1); 

  
res1.next(); 
try{
    rowTotal=Integer.parseInt(res1.getString(1));
}//end try
catch(Exception e){
    System.out.println(e);
}//end catch

  con.close();

         }//end try
        catch (Exception e){
            System.out.println(e);
        }//end catch
    }//end count
    
    
    private void displayData(){
    
    try{
     
        count();
   
        tableRaw=new Object[rowTotal][cols];
accessDB( );
String ss1;
    ss1="SELECT * FROM "+tableName+" ORDER BY "+ tableColHeads[1];
    ResultSet res1 = stat.executeQuery(ss1);
  for(i=1;res1.next();i++)
      for(j=1;j<=cols;j++){
      tableRaw[i-1][j-1]=res1.getString(j+1);
            if(j==cols && "Y".equals(tableRaw[i-1][j-1]) )
          rowY+=1;
      }
   
   con.close();
   tableY=new Object[rowY][cols];
   
   tableN=new Object[rowTotal-rowY][cols];
   
   int i1=0,i2=0;
    for(i=0;i<rowTotal;i++){
      
      if( "Y".equals(tableRaw[i][cols-1]) ){
          
          for(j=0;j<cols;j++)
         tableY[i1][j]=tableRaw[i][j];
         
         i1++;
      }//end if 
      
      else {
          for(j=0;j<cols;j++)
         tableN[i2][j]=tableRaw[i][j];
         
         i2++;
           
      }//end else
      }//end for*/
   

       if( rdbtAllData.isSelected() ){  
 rowShown=rowTotal;
tableShown=new Object[rowShown][cols];
tableShown=tableRaw;
 }//end if
   
 else if(rdbtYData.isSelected() ){  
if(rowY>0){
     rowShown=rowY;
tableShown=new Object[rowShown][cols];
tableShown=tableY;
}//end if
else{
      JOptionPane.showMessageDialog(this," The Database contains no Active Data. ","Sorry!",JOptionPane.ERROR_MESSAGE);    
      rdbtAllData.requestFocus();
rdbtAllDataSelected();
      
}//end else
 }//end else if 1
   
 else if(rdbtNData.isSelected() ){  
if(rowTotal-rowY>0){     
     rowShown=rowTotal-rowY;
tableShown=new Object[rowShown][cols];
tableShown=tableN;
 }
else{
      JOptionPane.showMessageDialog(this," The Database contains no Inactive Data. ","Sorry!",JOptionPane.ERROR_MESSAGE);    
      rdbtAllData.requestFocus();
rdbtAllDataSelected();
      
}//end else
   
 }//end else if 1
final boolean cellUnEditable[] = {false,false,false,false};    

tblDB.setModel(new javax.swing.table.DefaultTableModel(tableShown,tableColHeadsShown){
public boolean isCellEditable(int rowIndex, int columnIndex) {
                return cellUnEditable [columnIndex];
            }
        });  
        
        
 //tblDB.setCellEditor(tblDB.cellEditor) ;
 //tblDB.setAlignmentX(tblDB.RIGHT_ALIGNMENT);       

        //DefaultTableModel(Object[][],String [])*/

/*{
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        }//*/


  h=tblDB.getRowHeight()*(rowShown+1); 
 if(h<240)
jScrollPane1.setSize(500,h+5);
   else
     jScrollPane1.setSize(500,240);  

  }//end try
    
    catch(Exception e){
        System.out.println(e);
    }//end exception
    
}//end displayData

    
   private void addData()throws SQLException{
int opt=JOptionPane.showConfirmDialog(this,"Are you sure you want to save these data?            ","You are about to add new data to the Database....",JOptionPane.YES_NO_OPTION,JOptionPane.QUESTION_MESSAGE);       

    if(opt==0){
         initialise();       
    try{//main try
        accessDB();
        
        
    String    ss="INSERT INTO  " + tableName + " (" +ss1+ ") VALUES "+" ("+ss2+")";
    
    System.out.println(ss);
    
    
    stat.executeUpdate(ss);  
    updateCode();        
                    
                }//end main try
    
    catch(java.sql.SQLException e){//main catch

            con.close();
        
        System.out.println("ERROR IN addData : 1009 :\t"+e);
    }//end main exception
    }//end if

            txtName.setText("");
            txtRemarks.setText("");
            txtName.requestFocus();
            pnlHome.setVisible(true);
pnlSearch.setVisible(false);
pnlAddMod.setVisible(false);

    add=false; 

    
}//end addData

     private void modifyData(){
int opt=JOptionPane.showConfirmDialog(this,"Are you sure you want to modify these data?","You are about to modify the Database... ",JOptionPane.YES_NO_OPTION,JOptionPane.QUESTION_MESSAGE);       

    if(opt==0){
         
    try{
    
accessDB();
String ss1,ss2;
    
ss1="UPDATE "+tableName+ " SET "+ tableColHeads[1]+"  = '"+name+"'  WHERE "+tableColHeads[0]+" = '"+(String)(tableShown[selrow][0])+"' ";
ss2="UPDATE "+tableName+ " SET "+ tableColHeads[2]+"  = '"+remarks+"'  WHERE "+tableColHeads[0]+" = '"+(String)(tableShown[selrow][0])+"' ";

System.out.println(ss1);
System.out.println(ss2);
   stat.executeUpdate(ss1);
   stat.executeUpdate(ss2);   
    con.close();
    
    }//end try
    
    catch(Exception e){
        System.out.println(e);
    }//end exception
    
    displayData();
    
    }//end if
            txtName.setText("");
            txtRemarks.setText("");
            txtCode.setEditable(true);
            pnlAddMod.setVisible(false);    
            pnlHome.setVisible(true);  
    
}//end modifyData */
    
    
    
    
 public void  sortStrings(Object[][] rawData,int rows,int colNo){
  
     try{
     list.removeAllElements();  } catch(Exception e){System.out.println(e);}
     //SORTS THE CONTENTS IN ASCENDING ORDER
    sorted=new String[rows];

    unsorted=new String[rows];

    
     for(j=0;j<rows;j++){       
         unsorted[j]=((String)(rawData[j][colNo])).trim();
         sorted[j]=unsorted[j];
        
     }


        
     for(j=0;j<rows;j++){         //outer loop
         
         for(i=j+1;i<rows;i++){         //inner loop
             
             if(sorted[i].compareToIgnoreCase(sorted[j]) <0){
                 
                 String temp = sorted[j];
                 sorted[j]=sorted[i];
                 sorted[i]=temp;
             }//end if
         }//end inner loop
             
     }//end outer loop

     
     
     
     
     for(j=0;j<rows;j++){         
         list.addElement(sorted[j]);
           listSearch.setListData(list);
         
     }
         
 
     
    
 }//end sortStrings methd.  
    
    
public void displaySearch(){
    
    for(i=0;i<sorted.length;i++){
        
    if( sorted[i].regionMatches( true,0,key,0,key.length() ) ){

    listSearch.setSelectedValue(sorted[i],true);

int index=searchElement(sorted[i],unsorted);
      tblDB.clearSelection();
      tblDB.changeSelection( index ,0,true,false);
            eleFound=true; 
       //listSearch.set     
           
        break;
        }//end if*/
    
    }//end for
    
    if(!eleFound){
  JOptionPane.showMessageDialog(this," No match found. ","Sorry!",JOptionPane.ERROR_MESSAGE);    
  if(key.length()==1){
  listSearch.setSelectedIndex(0);
        tblDB.changeSelection( 0 ,0,true,false);
  txtSearch.setText(""+listSearch.getSelectedValue());
  txtSearch.selectAll();
  txtSearch.requestFocus();
  key="";
  
  }//end if
  else{
sb= new StringBuffer(key);
sb.setLength(sb.length()-1);
key=sb.toString();    
displaySearch();
txtSearch.setSelectionStart(key.length());
  }//end else
    }//end if
 
    eleFound=false;
    
/*            Rectangle b = new Rectangle(0,100,170,100);
            jScrollPane2.scrollRectToVisible(b);//*/
     
   
}//end displaySearch methd.

private void search(){

          
            list=new Vector(rowShown);
            
    
    if( "CODE".equals( cbSearch.getSelectedItem() ) )
            sortStrings(tableShown,rowShown,0); 
    else
            sortStrings(tableShown,rowShown,1); 
            

       displaySearch();

        txtSearch.requestFocus();
        

}//end search methd.


private void modifyActivate(String opt,int row){

    
    try{
    
accessDB();
    String ss1;
    
    ss1="UPDATE "+tableName+" SET Active  = '"+opt+"'  WHERE " +tableColHeads[0]+ "= '" + (String)(tableShown[row][0]) + "' ";
   
   stat.executeUpdate(ss1);
    con.close();
    
            btInactivate.setEnabled(true);
        btActivate.setEnabled(true);
        btAdd.setEnabled(true);
         btModify.setEnabled(true);
btSearch.setEnabled(true);

    rdbtAllData.setSelected(true);
    displayData();
    
    
    }//end try
    
    catch(Exception e){
        System.out.println(e);
    }//end exception
    

}//end modifyActivate


private int searchElement(String key,String[] a){
    int indx=-1;
    for(i=0;i<a.length;i++){
        if( key.equals(a[i]) )
            indx=i;
    }//end for
    
    
    return indx;
}//end searchElement
    
 public void  accessDB(){
     try{
    java.lang.Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
    
    con = java.sql.DriverManager.getConnection("jdbc:odbc:sha");
    
     stat = con.createStatement();
     }//end try
     catch(Exception e){
         System.out.println(e);
     }//end catch
   
     
 }//end accessDB
 
 private void initialise(){
     dbParam = new String[tableColHeads.length];
             ss1="";
             ss2="";
     
     //initialise dbParam with the variables that have the values to be entered in the database
     dbParam[0]="'"+code+"'";
     dbParam[1]="'"+name+"'";
     dbParam[2]="'"+remarks+"'";
     dbParam[3]="'Y'";
          for(i=0;i<tableColHeads.length;i++){
         ss1+=tableColHeads[i];
         ss2+=dbParam[i];
         if(i!=tableColHeads.length-1){
             ss1+=",";
             ss2+=",";
         }
         
              }//end for
     

 }//end initialise*/

     

private void addPressed(){
add=true;
pnlHome.setVisible(false);
pnlAddMod.setVisible(true);
}//end addPressed methd.
    
private void modifyPressed(){
if(  rowTotal==0   )
JOptionPane.showMessageDialog(this," The Database is currently empty.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if(  rowY==0 && rdbtYData.isSelected()  )
JOptionPane.showMessageDialog(this," The Database currently has no active data.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if(  rowTotal==rowY && rdbtNData.isSelected() )
JOptionPane.showMessageDialog(this," The Database currently contains no inactive data.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if(click && tableShown[selrow][3].equals("N"))
JOptionPane.showMessageDialog(this," Cannot modify Inactive data: Activate it first.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if( click ){
txtCode.setText((String)(tableShown[selrow][0]));
txtName.setText((String)(tableShown[selrow][1]));
txtName.selectAll();
txtRemarks.setText((String)(tableShown[selrow][2]));
txtRemarks.selectAll();
pnlHome.setVisible(false);   
pnlAddMod.setVisible(true);
click=false;
      }//end if
else if(!click)
      JOptionPane.showMessageDialog(this," Select the Item you want to modify from the Table.","No Item Selected!",JOptionPane.ERROR_MESSAGE); 
     tblDB.clearSelection();   

}//end modifyPressed methd.

private void searchPressed(){

if(  rowTotal==0   )
JOptionPane.showMessageDialog(this," The Database is currently empty.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if(  rowY==0 && rdbtYData.isSelected()  )
JOptionPane.showMessageDialog(this," The Database currently has no active data.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if(  rowTotal==rowY && rdbtNData.isSelected() )
JOptionPane.showMessageDialog(this," The Database currently contains no inactive data.","Sorry!",JOptionPane.ERROR_MESSAGE); 
        else{        
pnlSearch.setVisible(true);
pnlAddMod.setVisible(false);
cbSearch.setSelectedIndex(0); // index 0 corre3sponds to the 1st item of combo box
rdbtAllData.setEnabled(false);
rdbtYData.setEnabled(false);
rdbtNData.setEnabled(false);
btAdd.setEnabled(false);
btModify.setEnabled(false);
btSearch.setEnabled(false);
btActivate.setEnabled(false);
btInactivate.setEnabled(false);
btExit.setEnabled(false);
        }//end else
}//end searchPressed methd.

private void activatePressed(){
if(  rowTotal==0   )
JOptionPane.showMessageDialog(this," The Database is currently empty.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if(  rowY==0 && rdbtYData.isSelected()  )
JOptionPane.showMessageDialog(this," The Database currently has no active data.","Sorry!",JOptionPane.ERROR_MESSAGE); 
else if(  rowTotal==rowY && rdbtNData.isSelected() )
JOptionPane.showMessageDialog(this," The Database currently contains no inactive data.","Sorry!",JOptionPane.ERROR_MESSAGE); 
    
        else if(!click)
      JOptionPane.showMessageDialog(this," Select the Item you want to modify from the Table. ","No Items selected!",JOptionPane.ERROR_MESSAGE); 
        else if (click){
          tblDB.setRowSelectionAllowed(true);   
if(selrow>=0){
    if(activate){
        if(tableShown[selrow][3].equals("Y"))
JOptionPane.showMessageDialog(this," Selected item is already Active!","",JOptionPane.ERROR_MESSAGE); 
        else{//inner else  
int opt=JOptionPane.showConfirmDialog(this,"Are you sure you want to Activate the selected data?            ","You are about to Activate an Inactive data....",JOptionPane.YES_NO_OPTION,JOptionPane.QUESTION_MESSAGE);       

    if(opt==0)
        modifyActivate("Y",selrow);
        }//end inner else
    }//end if
    else{
        if(tableShown[selrow][3].equals("N"))
JOptionPane.showMessageDialog(this," Selected item is already Inactive!","",JOptionPane.ERROR_MESSAGE); 
        else {//inner else   
            int opt=JOptionPane.showConfirmDialog(this,"Are you sure you want to Inactivate the selected data?            ","You are about to Inactivate an Active data....",JOptionPane.YES_NO_OPTION,JOptionPane.QUESTION_MESSAGE);       

    if(opt==0)
modifyActivate("N",selrow);

        }//end inner else
    }//end else
          click=false;
}//end else if
      } 

}//end activePressed methd.

private void addSavePressed(){
        code=txtCode.getText().trim();
        name=txtName.getText().trim();
        remarks=txtRemarks.getText().trim();
        duplicate=false;
        for(i=0;i<rowShown;i++)
            if( name.compareTo(tableShown[i][1].toString())==0 ){
                duplicate=true;
                break;
            }//end if
            
if(name.equals("")){
         JOptionPane.showMessageDialog(this," The Name-field is empty  ","Error!",JOptionPane.ERROR_MESSAGE);
                   txtName.setText("");
                   txtName.requestFocus();
          
   }//end if
                        else if(remarks.equals("")){
         JOptionPane.showMessageDialog(this," The Remarks-field is empty  ","Error!",JOptionPane.ERROR_MESSAGE);
          txtRemarks.setText("");
          txtRemarks.requestFocus();
                        }//end else if
  
else if(duplicate && add){
    JOptionPane.showMessageDialog(this," This name already exists: enter an unique name.","Error!",JOptionPane.ERROR_MESSAGE);
          txtName.setText("");
          txtName.requestFocus();
    
}//end else if
        
 else{
            if(add){
                try{
    addData();
                }
                catch(Exception e){
                    System.out.println("1393 :\t"+e);
                }
             }
else{//inner else
    if(duplicate && tableShown[i][0].equals(txtCode.getText()) || !duplicate)
    modifyData();
    else{//else
    JOptionPane.showMessageDialog(this," This name already exists: enter an unique name.","Error!",JOptionPane.ERROR_MESSAGE);
          txtName.setText("");
          txtName.requestFocus();
    
}//end else
}//end inner else
            displayData();

        }//end else
}//end addSavePressed methd.


private void addCancelPressed(){

txtName.setText("");
txtRemarks.setText("");
add=false;
pnlAddMod.setVisible(false);
pnlHome.setVisible(true);
}//end addCancelPressed methd.

private void searchCancelPressed(){
cbSearch.setSelectedItem("CODE");
list.removeAllElements();
pnlHome.setVisible(true);
pnlSearch.setVisible(false);
pnlAddMod.setVisible(false);
rdbtAllData.setEnabled(true);
rdbtYData.setEnabled(true);
rdbtNData.setEnabled(true);
btExit.setEnabled(true);
btAdd.setEnabled(true);
btModify.setEnabled(true);
btSearch.setEnabled(true);
btActivate.setEnabled(true);
btInactivate.setEnabled(true);
txtSearch.setText("");
    
}

private void generateCode() {
    try{
        accessDB();
        String ss = "SELECT * FROM SemaPhores WHERE TableName = 'CO_Grp'";
        ResultSet res = stat.executeQuery(ss);
        res.next();
        
        String s =""+ res.getString(3);
        System.out.println(s);
        ctr = Integer.parseInt(res.getString(4));
        if(s.equals("null"))
        txtCode.setText(""+ctr);
        else
        txtCode.setText(s+ctr);
        con.close();
    }//end try
    catch(Exception e){
        System.out.println(e+"\n1393");
    }//end catch
}

private void updateCode() {
    try{
        accessDB();
        ctr++;
        String ss1 = "UPDATE SemaPhores SET  MaxCtr = "+ctr+" WHERE TableName = 'CO_Grp' ";
        stat.executeUpdate(ss1);
        
        con.close();
    }//end try
    catch(Exception e){
        System.out.println(e+"\n2753");
    }//end catch
}

//end searchCancelPressed

private void rdbtAllDataSelected(){
            rdbtAllData.setSelected(true);
                     btInactivate.setEnabled(true);
        btActivate.setEnabled(true);
        btAdd.setEnabled(true);
         btModify.setEnabled(true);

        displayData();    
}//end rdbtAllDataSelected()

private void rdbtYDataSelected(){
            rdbtYData.setSelected(true);
                    btActivate.setEnabled(false);
        btInactivate.setEnabled(true);
        btModify.setEnabled(true);
        btAdd.setEnabled(true);
        displayData();
    
}//end rdbtYDataSelected()

private void rdbtNDataSelected(){
            rdbtNData.setSelected(true);
                    btInactivate.setEnabled(false);
btAdd.setEnabled(false);
btModify.setEnabled(false);
btActivate.setEnabled(true);
        displayData();       
    
}//end rdbtNDataSelected()


Object tableShown[][],tableY[][],tableN[][],tableRaw[][];
String tableColHeads[],code=new String(),name=new String(),remarks,sorted[],unsorted[],key="";
int rowTotal=0,cols=0,i=0,j=0,selrow=0,rowY=0,rowShown=0,h=0,ctr=0,listClicked2=0;
boolean eleFound=false,tab=false,click=false,duplicate=false,listSelectionChanged=false;
StringBuffer sb;
Vector list;
Statement stat;
Connection con;

String tableName="CO_Grp",dbParam[],ss,ss1="",ss2="";    

String tableColHeadsShown[]={"Code","Name","Remarks","Active"};    
boolean add=false,home=true,activate=false,controlKey=false;    


}//end main

